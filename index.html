<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Actividades T√©cnicas</title>
    <link rel="stylesheet" href="assets/styles.css?v=32">
</head>
<body>
    <div class="container">
        <header>
            <img src="assets/logo.png" alt="Logo MPF La Rioja" class="header-logo">
            <h1>Registro de Actividades T√©cnicas</h1>
            <p>Ministerio P√∫blico Fiscal - La Rioja</p>
        </header>

        <div class="header-actions">
            <button type="button" id="btnSolicitantes" class="btn-solicitantes" onclick="abrirModalSolicitantes()">üë• Solicitantes</button>
            <button type="button" id="btnStock" class="btn-stock" onclick="abrirModalStock()">üì¶ Stock</button>
            <button type="button" id="exportBtn" class="btn-export" onclick="event.preventDefault(); event.stopPropagation();">üì• Exportar Datos</button>
        </div>

        <main>
            <section class="form-section">
                <h2>Nueva Actividad</h2>
                <form id="activityForm">
                    <div class="form-group">
                        <label for="fecha">Fecha:</label>
                        <input type="date" id="fecha" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="tecnico">T√©cnico:</label>
                        <select id="tecnico" required>
                            <option value="">Seleccione el t√©cnico</option>
                            <option value="Carlos Beres">Carlos Beres</option>
                            <option value="Santiago Somerville">Santiago Somerville</option>
                            <option value="Omar Vallejos">Omar Vallejos</option>
                            <option value="Maximiliano Burela Tello">Maximiliano Burela Tello</option>
                            <option value="Ricardo Cuello">Ricardo Cuello</option>
                            <option value="Jorge Olmedo">Jorge Olmedo</option>
                            <option value="Lucas Vega">Lucas Vega</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="tipo">Tipo de Problema:</label>
                        <select id="tipo" required>
                            <option value="">Seleccione el tipo</option>
                            <option value="mantenimiento">Mantenimiento</option>
                            <option value="reparacion">Reparaci√≥n</option>
                            <option value="instalacion">Instalaci√≥n</option>
                            <option value="soporte">Soporte T√©cnico</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="solicitante">Solicitante:</label>
                        <div class="solicitante-input-group">
                            <input type="text" id="solicitante" placeholder="Escriba para buscar solicitantes..." required>
                            <input type="hidden" id="solicitanteId">
                            <button type="button" id="abrirModalPersonas" class="btn-seleccionar-persona">üìã</button>
                            <div id="sugerenciasSolicitante" class="sugerencias-container"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="descripcion">Descripci√≥n:</label>
                        <textarea id="descripcion" placeholder="Describa la actividad realizada..." rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="estado">Estado:</label>
                        <select id="estado" required>
                            <option value="">Seleccione estado</option>
                            <option value="completado">Completado</option>
                            <option value="pendiente">Pendiente</option>
                        </select>
                    </div>
                    
                    <button type="submit">Registrar Actividad</button>
                </form>
            </section>

            <section class="list-section">
                <h2>Actividades Registradas</h2>
                <div class="filters">
                    <input type="text" id="searchInput" placeholder="Buscar actividades...">
                    <select id="filterTipo">
                        <option value="">Todos los tipos</option>
                        <option value="mantenimiento">Mantenimiento</option>
                        <option value="reparacion">Reparaci√≥n</option>
                        <option value="instalacion">Instalaci√≥n</option>
                        <option value="soporte">Soporte T√©cnico</option>
                        <option value="otro">Otro</option>
                    </select>
                    <select id="filterEstado">
                        <option value="">Todos los estados</option>
                        <option value="completado">Completado</option>
                        <option value="pendiente">Pendiente</option>
                    </select>
                </div>
                
                <div id="activitiesList" class="activities-list">
                    <!-- Las actividades se cargar√°n aqu√≠ -->
                </div>
            </section>
        </main>
    </div>

    <!-- Modal para gesti√≥n de personas (Solo formulario de nuevo solicitante) -->
    <div id="modalPersonas" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Agregar Nuevo Solicitante</h2>
            </div>
            
            <div class="modal-body">
                <!-- Solo formulario para nueva persona -->
                <div class="new-person-section">
                    <form id="formularioPersona">
                        <div class="form-row">
                            <input type="text" id="nuevaPersonaNombre" placeholder="Nombre" required>
                            <input type="text" id="nuevaPersonaApellido" placeholder="Apellido" required>
                        </div>
                        <div class="form-row">
                            <select id="nuevaPersonaCircunscripcion" required>
                                <option value="">Seleccione circunscripci√≥n</option>
                                <option value="Primera Circunscripci√≥n Capital">Primera Circunscripci√≥n Capital</option>
                                <option value="Segunda Circunscripci√≥n Chilecito">Segunda Circunscripci√≥n Chilecito</option>
                                <option value="Tercera Circunscripci√≥n Chamical">Tercera Circunscripci√≥n Chamical</option>
                                <option value="Cuarta Circunscripci√≥n Aimogasta">Cuarta Circunscripci√≥n Aimogasta</option>
                                <option value="Quinta Circunscripci√≥n Chepes">Quinta Circunscripci√≥n Chepes</option>
                                <option value="Sexta Circunscripci√≥n Villa Uni√≥n">Sexta Circunscripci√≥n Villa Uni√≥n</option>
                            </select>
                            <select id="nuevaPersonaCargo" required>
                                <option value="">Seleccione cargo</option>
                                <option value="Operador">Operador</option>
                                <option value="Fiscal">Fiscal</option>
                            </select>
                        </div>
                        <div class="form-buttons">
                            <button type="submit">Agregar Solicitante</button>
                            <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para gesti√≥n de solicitantes -->
    <div id="modalSolicitantes" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üè¢ Gesti√≥n de Solicitantes</h3>
                <span class="close" onclick="cerrarModalSolicitantes()">&times;</span>
            </div>
            <div class="modal-body">
                <!-- Barra de b√∫squeda -->
                <div class="search-section">
                    <input type="text" id="buscarSolicitante" placeholder="üîç Buscar por nombre, apellido, cargo o circunscripci√≥n..." class="search-input-large">
                </div>
                
                <!-- Tabla de solicitantes -->
                <div class="tabla-container">
                    <table class="tabla-solicitantes">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Apellido</th>
                                <th>Circunscripci√≥n</th>
                                <th>Cargo</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="cuerpoTablaSolicitantes">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Mensaje cuando no hay resultados -->
                <div id="mensajeSinResultados" class="no-results" style="display: none;">
                    <p>No se encontraron solicitantes</p>
                </div>
            </div>
        </div>
    </div>



    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    
    <script src="gestor-solicitantes.js"></script>
    <script src="modelo/modelo.js"></script>
    <script src="modelo/modelo-personas.js"></script>
    <script src="vista/vista.js"></script>
    <script src="vista/vista-formulario-solicitante.js"></script>
    <script src="controlador/controlador.js"></script>
    
    <!-- Scripts para gesti√≥n de inventario/stock -->
    <script src="modelo/modelo-stock.js"></script>
    <script src="vista/vista-stock.js"></script>
    <script src="controlador/controlador-stock.js"></script>
    
    <script src="aplicacion.js"></script>
    
    <!-- Modal de Confirmaci√≥n -->

    <!-- Modal de Edici√≥n de Actividades -->
    <div id="modalEdicionActividad" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>‚úèÔ∏è Editar Actividad</h3>
                <span class="close" onclick="cerrarModalEdicionActividad()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="formEdicionActividad">
                    <input type="hidden" id="edicionActividadId">
                    
                    <div class="form-group">
                        <label for="edicionFecha">Fecha:</label>
                        <input type="date" id="edicionFecha" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edicionTecnico">T√©cnico:</label>
                        <select id="edicionTecnico" required>
                            <option value="">Seleccione el t√©cnico</option>
                            <option value="Carlos Beres">Carlos Beres</option>
                            <option value="Santiago Somerville">Santiago Somerville</option>
                            <option value="Omar Vallejos">Omar Vallejos</option>
                            <option value="Maximiliano Burela Tello">Maximiliano Burela Tello</option>
                            <option value="Ricardo Cuello">Ricardo Cuello</option>
                            <option value="Jorge Olmedo">Jorge Olmedo</option>
                            <option value="Lucas Vega">Lucas Vega</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edicionTipo">Tipo de Problema:</label>
                        <select id="edicionTipo" required>
                            <option value="">Seleccione el tipo</option>
                            <option value="mantenimiento">Mantenimiento</option>
                            <option value="reparacion">Reparaci√≥n</option>
                            <option value="instalacion">Instalaci√≥n</option>
                            <option value="soporte">Soporte T√©cnico</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edicionSolicitante">Solicitante:</label>
                        <div class="solicitante-input-group">
                            <input type="text" id="edicionSolicitante" placeholder="Solicitante" readonly>
                            <input type="hidden" id="edicionSolicitanteId">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edicionDescripcion">Descripci√≥n:</label>
                        <textarea id="edicionDescripcion" placeholder="Describa la actividad realizada..." rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="edicionEstado">Estado:</label>
                        <select id="edicionEstado" required>
                            <option value="">Seleccione estado</option>
                            <option value="completado">Completado</option>
                            <option value="pendiente">Pendiente</option>
                            <option value="en-proceso">En proceso</option>
                            <option value="cancelado">Cancelado</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancelar" onclick="cerrarModalEdicionActividad()">Cancelar</button>
                        <button type="submit" class="btn-guardar">üíæ Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n gen√©rico para eliminar -->
    <div id="modalConfirmacion" class="modal modal-confirmacion" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalConfirmacionTitulo">‚ö†Ô∏è Confirmar Eliminaci√≥n</h3>
                <button class="btn-cerrar" onclick="cerrarModalConfirmacion()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modalConfirmacionMensaje">¬øEst√° seguro de que desea eliminar este elemento?</p>
                <p class="texto-advertencia">Esta acci√≥n no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancelar" onclick="cerrarModalConfirmacion()">Cancelar</button>
                <button type="button" class="btn-confirmar" onclick="confirmarEliminacion()">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Modal para gesti√≥n de inventario/stock -->
    <div id="modalStock" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üì¶ Gesti√≥n de Inventario</h3>
                <span class="close" onclick="cerrarModalStock()">&times;</span>
            </div>
            <div class="modal-body">
                
                <!-- Barra de b√∫squeda, filtros y botones en l√≠nea -->
                <div class="controles-superiores">
                    <div class="busqueda-filtros">
                        <input type="text" id="buscarStock" placeholder="üîç Buscar por nombre, modelo o serial..." class="search-input-inline">
                        <select id="filtroEstado" class="filtro-inline">
                            <option value="">Todos los estados</option>
                            <option value="nuevo">Nuevo</option>
                            <option value="usado">Usado</option>
                            <option value="reparado">Reparado</option>
                            <option value="dado-de-baja">Dado de baja</option>
                        </select>
                    </div>
                </div>
                
                <!-- Tabla de inventario -->
                <div class="tabla-stock-container">
                    <table class="tabla-stock">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Modelo</th>
                                <th>Serial</th>
                                <th>Cantidad</th>
                                <th>Estado</th>
                                <th>Ubicaci√≥n</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        
                        <!-- Fila de edici√≥n r√°pida -->
                        <tbody id="filaEdicionRapida">
                            <tr class="fila-edicion-rapida">
                                <td><input type="text" class="input-edicion-rapida" placeholder="Nombre" id="rapidaNombre"></td>
                                <td><input type="text" class="input-edicion-rapida" placeholder="Modelo" id="rapidaModelo"></td>
                                <td><input type="text" class="input-edicion-rapida" placeholder="Serial" id="rapidaSerial"></td>
                                <td><input type="number" class="input-edicion-rapida" placeholder="1" min="1" value="1" id="rapidaCantidad"></td>
                                <td>
                                    <select class="input-edicion-rapida" id="rapidaEstado">
                                        <option value="nuevo">Nuevo</option>
                                        <option value="usado">Usado</option>
                                        <option value="reparado">Reparado</option>
                                        <option value="dado-de-baja">Dado de baja</option>
                                    </select>
                                </td>
                                <td><input type="text" class="input-edicion-rapida" placeholder="Ubicaci√≥n" id="rapidaUbicacion"></td>
                                <td class="fecha-auto">Auto</td>
                                <td>
                                    <button type="button" class="btn-guardar-rapido" onclick="guardarEdicionRapida()" title="Guardar">‚úÖ</button>
                                    <button type="button" class="btn-cancelar-rapido" onclick="cancelarEdicionRapida()" title="Cancelar">‚ùå</button>
                                </td>
                            </tr>
                        </tbody>
                        
                        <tbody id="cuerpoTablaStock">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


</body>
</html>